<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>车险退保计算器</title>
  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
  <style>
    body {
      margin: 0;
      padding: 0;
    }
  </style>
</head>

<body>
  <div id="app">
    <v-app>
      <v-container fluid>
        <v-layout row wrap justify-center>
          <v-flex xs12 sm8 md6 lg4>
            <v-card class="calculator-card">
              <v-card-title primary-title>
                <h2 class="headline mb-0 text-h4">车险退保计算器</h2>
              </v-card-title>
              <v-card-text>
                <v-form ref="form">
                  <v-text-field v-model="premium" label="保单保费" placeholder="请输入金额" required></v-text-field>
                  <v-text-field v-model="startDate" label="保单生效时间" type="date" required></v-text-field>
                  <v-text-field v-model="policyPercentage" label="政策" placeholder="请输入数字（如 5 代表 5%）" required></v-text-field>
                  <v-alert v-if="hasError" type="error">{{ errorMessage }}</v-alert>
                </v-form>
              </v-card-text>
              <v-card-actions>
                <v-spacer></v-spacer>
                <v-btn color="green" @click="calculate">计算</v-btn>
              </v-card-actions>
              <v-card-text v-if="result" class="pt-3">
                <p>退保保费：{{ refundPremiumFormatted }} 元</p>
                <p>收回佣金：{{ commissionFormatted }} 元</p>
              </v-card-text>
            </v-card>
          </v-flex>
        </v-layout>
      </v-container>
    </v-app>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
  <script>
    new Vue({
      el: '#app',
      data: {
        premium: null,
        startDate: null,
        policyPercentage: null,
        hasError: false,
        errorMessage: '',
        result: false,
        refundPremium: null,
        commission: null
      },
      methods: {
        calculate() {
          this.hasError = false;
          this.errorMessage = '';
          const premium = parseFloat(this.premium);
          const startDate = new Date(this.startDate);
          const policyPercentage = parseFloat(this.policyPercentage);

          if (isNaN(premium) || premium <= 0) {
            this.hasError = true;
            this.errorMessage = '请输入正确的保单保费金额';
            return;
          }

          if (isNaN(startDate.getTime())) {
            this.hasError = true;
            this.errorMessage = '请选择正确的保单生效时间';
            return;
          }

          if (isNaN(policyPercentage) || policyPercentage < 0 || policyPercentage > 100) {
            this.hasError = true;
            this.errorMessage = '请输入正确的政策（0-100 之间的数字）';
            return;
          }

          const currentDate = new Date();
          const elapsedDays = Math.floor((currentDate - startDate) / (1000 * 60 * 60 * 24));
          const remainingDays = 365 - elapsedDays;
          this.refundPremium = premium / 365 * remainingDays;
          this.commission = this.refundPremium / 1.06 * (policyPercentage / 100);
          this.refundPremiumFormatted = this.refundPremium.toFixed(2);
          this.commissionFormatted = this.commission.toFixed(2);
          this.result = true;
        }
      }
    });
  </script>
</body>

</html>
